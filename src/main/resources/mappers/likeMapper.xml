<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sns.like.mapper.LikeMapper">
	<!-- insert 좋아요 추가 쿼리 -->
	<insert id="insertLike">
		INSERT INTO `like`
		(
		`postId`
		,`userId`
		,`createdAt`
		)
		VALUES 
		(
		#{postId}
		,#{userId}
		,NOW()
		)
	</insert>
	<!-- select postId, userId가 DB에 있는지 없는지 조회하는 쿼리 -->
	<select id="countLikeByPostIdAndUserId" parameterType="map" resultType="int">
    SELECT 
        COUNT(*)
    FROM 
        `like`
    WHERE 
        `postId` = #{postId} 
        AND `userId` = #{userId}
	</select>
	<!-- DB에 postId와 userId가 있다면 삭제하는 쿼리 -->
	<delete id="deleteLikeByPostIdAndUserId">
        DELETE 
        FROM 
        	`like`
        WHERE 
            `postId` = #{postId} 
            AND `userId` = #{userId}
    </delete>
    <select id="selectLikeCountByPostId" parameterType="int" resultType="int">
    SELECT 
        COUNT(*)
    FROM 
        `like`
    WHERE 
        `postId` = #{postId} 
	</select>
</mapper>